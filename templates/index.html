<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Concierge Chat Analyzer</title>
    <!-- External CDN Libraries -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    
    <!-- Application CSS -->
    <link rel="stylesheet" href="/static/css/main.css">
    <link rel="stylesheet" href="/static/css/dashboard.css">
    <link rel="stylesheet" href="/static/css/conversations.css">
    <link rel="stylesheet" href="/static/css/debug-insights.css">
</head>
<body>
    <div class="container-fluid">
        <!-- Header Section -->
        {% include 'partials/header.html' %}
        
        <!-- Upload Form -->
        {% include 'partials/upload-form.html' %}
        
        <!-- Loading Indicator -->
        <div id="loading" class="text-center my-5 d-none">
            <div class="spinner-border text-primary" role="status">
                <span class="visually-hidden">Loading...</span>
            </div>
            <p class="mt-2">Analyzing chat data...</p>
        </div>
        
        <!-- Results Container -->
        <div id="results-container" class="d-none">
            <!-- Export PDF floating button for mobile -->
            <button id="export-pdf-mobile" class="btn btn-primary export-button d-md-none">
                <i class="bi bi-file-earmark-pdf"></i>
            </button>
            
            <!-- Dashboard Content -->
            {% include 'partials/dashboard/summary.html' %}
            {% include 'partials/dashboard/response-time.html' %}
            
            <!-- Analysis Tabs -->
            <ul class="nav nav-tabs mb-0" id="analysisTab" role="tablist">
                <li class="nav-item" role="presentation">
                    <button class="nav-link active" id="personas-tab" data-bs-toggle="tab" data-bs-target="#personas" 
                            type="button" role="tab" aria-controls="personas" aria-selected="true">
                        <i class="bi bi-people me-2"></i>Persona Analysis
                    </button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="recommendations-tab" data-bs-toggle="tab" data-bs-target="#recommendations" 
                            type="button" role="tab" aria-controls="recommendations" aria-selected="false">
                        <i class="bi bi-bar-chart-fill me-2"></i>Recommendations Analysis
                    </button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="conversations-tab" data-bs-toggle="tab" data-bs-target="#conversations" 
                            type="button" role="tab" aria-controls="conversations" aria-selected="false">
                        <i class="bi bi-chat me-2"></i>Conversations
                    </button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="debug-insights-tab" data-bs-toggle="tab" data-bs-target="#debug-insights" 
                            type="button" role="tab" aria-controls="debug-insights" aria-selected="false">
                        <i class="bi bi-bug me-2"></i>Debug Insights
                    </button>
                </li>
            </ul>
            
            <div class="tab-content" id="analysisTabContent">
                <!-- Tab Content -->
                {% include 'partials/tabs/personas.html' %}
                {% include 'partials/tabs/recommendations.html' %}
                {% include 'partials/tabs/conversations.html' %}
                {% include 'partials/tabs/debug-insights.html' %}
            </div>
        </div>
    </div>

    <!-- Bootstrap & Core JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- Application JS - Order matters for dependencies -->
    <script src="/static/js/config.js"></script>
    <script src="/static/js/chart-exporter.js"></script>
    <script src="/static/js/charts.js"></script>
    <script src="/static/js/conversations.js"></script>
    <script src="/static/js/debug-insights.js"></script>
    <script src="/static/js/pdf-export.js"></script>
    <script src="/static/js/main.js"></script>
</body>
</html>
